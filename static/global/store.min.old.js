(function(a,b){if(typeof define==="function"&&define.amd){define([],b)}else{if(typeof exports==="object"){module.exports=b()}else{a.store=b(a)}}}(this,function(j,e){if(!window.localStorage){return}var i=window.localStorage,n,l,o=function(){},m=function(){return true};function b(a){return typeof(a)==="object"&&Object.prototype.toString.call(a).toLowerCase()&&!a.length}function h(a){return a===e||typeof a==="function"?a+"":JSON.stringify(a)}function f(a){if(typeof a!=="string"){return e}try{return JSON.parse(a)}catch(p){return a||e}}function d(a){return({}).toString.call(a)==="[object Function]"}function c(a){return typeof a==="string"}function g(a){return a instanceof Array}l={set:function(p,q){if(q===e){return this.remove(p)}var a=this.get(p);var r=m("set",p,q,a);if(!(!!r||typeof(r)==void 0)){return false}i.setItem(p,h(q));o("set",p,q,a);return this},setAll:function(p){var r,q;for(var a in p){q=p[a];if(this.set(a,q)!==q){r=true}}return this},get:function(a){return f(i.getItem(a))},getAll:function(){var a={};this.forEach(function(p,q){a[p]=q});return a},clear:function(){notdel=[];this.forEach(function(r,s){var t=m("clear",r,null,s);if(!(!!t||typeof(t)==void 0)){notdel.push({key:r,val:s})}o("clear",r,null,s)});i.clear();var a=notdel.length,p=0;while(p<a){var q=notdel[0];i.setItem(q.key,h(q.val));p++}return this},remove:function(a){var p=this.get(a);var q=m("remove",a,null,p);if(!(!!q||typeof(q)==void 0)){return false}i.removeItem(a);o("remove",a,null,p);return this},has:function(a){return i.hasOwnProperty(a)},keys:function(){var a=[];this.forEach(function(p,q){a.push(p)});return a},size:function(){return this.keys().length},forEach:function(q){for(var p=0;p<i.length;p++){var a=i.key(p);if(q(a,this.get(a))===false){break}}return this},onStorage:function(a){if(a&&d(a)){o=a}return this},onBeforeStorage:function(a){if(a&&d(a)){m=a}return this}};n=function(a,q){var s=arguments,p=null,r=function(u,v){if(d(v)){if(c(u)){p=v(n.get(u));return p?n.set(u,p):e}if(g(u)){for(var t in u){p=v(n.get(u[t]));if(p){n.set(u[t],p)}}}return}if(b(u)){return n.setAll(u)}if(s.length===0){return n.getAll()}if(v===false){return n.remove(u)}if(v!==e){return n.set(u,v)}if(u){return n.get(u)}return n.setAll(u,v)};return r(a,q)};for(var k in l){n[k]=l[k]}window.store=n;return n}));